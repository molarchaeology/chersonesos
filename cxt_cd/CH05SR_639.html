<!DOCTYPE html 

     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"

     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
 <head>
  <!-- title -->
  <title>
   Chersonesos - Record View Page: CH05SR_639
  </title>
  <!-- meta -->
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <!-- stylesheets -->
  <link href="../skins/arkologik/stylesheets/ark_main.css" type="text/css" rel="stylesheet" media="screen" />
  <link href="../skins/arkologik/stylesheets/ark_main_print.css" type="text/css" rel="stylesheet" media="print" />
  <link href="../skins/arkologik/stylesheets/colorbox.css" type="text/css" rel="stylesheet" />
  <link href="../skins/arkologik/images/ark_favicon.ico" rel="shortcut icon" />
  <!-- javascript libraries -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js">
  </script>
  <script src="../lib/js/jquery.js" type="text/javascript">
  </script>
  <script src="../lib/js/jquery-ui.js" type="text/javascript">
  </script>
  <script src="../lib/js/php.js" type="text/javascript">
  </script>
  <script src="../lib/js/jquery.colorbox.js" type="text/javascript">
  </script>
  <script src="../lib/js/ol3/ol.js" type="text/javascript">
  </script>
  <!-- ARK javascript -->
  <script type="text/javascript" src="../js/js_functions.js">
  </script>
  <script src="../js/js_functions.js" type="text/javascript">
  </script>
  <script src="../js/livesearch.js" type="text/javascript">
  </script>
  <script src="../js/common.js" type="text/javascript">
  </script>
 </head>
 <body>
  <!-- THE CONTENT WRAPPER -->
  <div id="wrapper" class="wrp_mcrview">
   <!-- HEADER -->
   <div id="hdr-print">
    <img src="../skins/arkologik/images/logo.png" alt="logo" />
   </div>
   <div id="hdr">
    <!-- header tools -->
    <div id="hdr-tools">
     <!-- version number -->
     <div id="version">
      v1.1
     </div>
     <!-- user info -->
     <div id="user-info">
      <span>
       Guest User
      </span>
      <span>
       <a href="../micro_view.html">
        English
       </a>
      </span>
      <span>
       <a href="../micro_view.html">
        Russian
       </a>
      </span>
      <span>
       <a href="../help.html">
        Help
       </a>
      </span>
      <span class="noborder">
       <a href="../index.html">
        Logout
       </a>
      </span>
     </div>
     <!-- search box -->
     <div id="search">
      <form method="get" class="searchbox" action="/chersonesos/ark/data_view.php">
       <fieldset>
        <label>
         Search&nbsp;
        </label>
        <input type="text" name="src" />
        <input type="hidden" name="ftr_mode" value="basic" />
        <input type="hidden" name="disp_mode" value="chat" />
        <input type="hidden" name="ftype" value="ftx" />
        <input type="hidden" name="ftr_id" value="searchbox" />
        <input type="hidden" name="reset" value="1" />
        <button type="submit">
         go
        </button>
       </fieldset>
      </form>
     </div>
    </div>
    <!-- main navigation bar -->
    <div id="navcontainer">
     <ul id="navlist">
      <li>
       <a href="../user_home.html">
        home
       </a>
      </li>
      <li id="active">
       <a href="../micro_view.html">
        record view
       </a>
      </li>
      <li>
       <a href="../data_view.html">
        search
       </a>
      </li>
      <li>
       <a href="../map_view.html">
        map
       </a>
      </li>
     </ul>
    </div>
   </div>
   <!-- The LEFT PANEL -->
   <div id="lpanel">
    <h1>
     Micro View Forms
    </h1>
    <ul class="module_list" id="mvlpmodlist">
     <li>
      <a href="../micro_view.html">
       <img src="../skins/arkologik/images/plusminus/view.png" title="View a Context" class="med" />
      </a>
      <label>
       Contexts
      </label>
      <a href="../search/key/1/all.html">
       <img src="../skins/arkologik/images/plusminus/view_mag.png" title="Search Context" class="med" />
      </a>
     </li>
     <li>
      <a href="../micro_view.html">
       <img src="../skins/arkologik/images/plusminus/view.png" title="View a Group" class="med" />
      </a>
      <label>
       Context Groups
      </label>
      <a href="../search/key/16/all.html">
       <img src="../skins/arkologik/images/plusminus/view_mag.png" title="Search Group" class="med" />
      </a>
     </li>
     <li>
      <a href="../micro_view.html">
       <img src="../skins/arkologik/images/plusminus/view.png" title="View a Special Find" class="med" />
      </a>
      <label>
       Special Finds
      </label>
      <a href="../search/key/11/all.html">
       <img src="../skins/arkologik/images/plusminus/view_mag.png" title="Search Special Find" class="med" />
      </a>
     </li>
     <li>
      <a href="../micro_view.html">
       <img src="../skins/arkologik/images/plusminus/view.png" title="View a Sample" class="med" />
      </a>
      <label>
       Samples
      </label>
      <a href="../search/key/9/all.html">
       <img src="../skins/arkologik/images/plusminus/view_mag.png" title="Search Sample" class="med" />
      </a>
     </li>
     <li>
      <a href="../micro_view.html">
       <img src="../skins/arkologik/images/plusminus/view.png" title="View a Microwear Record" class="med" />
      </a>
      <label>
       Microwear Records
      </label>
      <a href="../search/key/19/all.html">
       <img src="../skins/arkologik/images/plusminus/view_mag.png" title="Search Microwear Record" class="med" />
      </a>
     </li>
     <li>
      <a href="../micro_view.html">
       <img src="../skins/arkologik/images/plusminus/view.png" title="View a Skeletal Remain" class="med" />
      </a>
      <label>
       Skeletal Remains
      </label>
      <a href="../search/key/20/all.html">
       <img src="../skins/arkologik/images/plusminus/view_mag.png" title="Search Skeletal Remain" class="med" />
      </a>
     </li>
     <li>
      <a href="../micro_view.html">
       <img src="../skins/arkologik/images/plusminus/view.png" title="View a Drawing" class="med" />
      </a>
      <label>
       Drawings
      </label>
      <a href="../search/key/17/all.html">
       <img src="../skins/arkologik/images/plusminus/view_mag.png" title="Search Drawing" class="med" />
      </a>
     </li>
     <li>
      <a href="../micro_view.html">
       <img src="../skins/arkologik/images/plusminus/view.png" title="View a Site Photo" class="med" />
      </a>
      <label>
       Site Photos
      </label>
      <a href="../search/key/3/all.html">
       <img src="../skins/arkologik/images/plusminus/view_mag.png" title="Search Site Photo" class="med" />
      </a>
     </li>
     <li>
      <a href="../micro_view.html">
       <img src="../skins/arkologik/images/plusminus/view.png" title="View a Geophoto" class="med" />
      </a>
      <label>
       GeoPhoto Codes
      </label>
      <a href="../search/key/12/all.html">
       <img src="../skins/arkologik/images/plusminus/view_mag.png" title="Search Geophoto" class="med" />
      </a>
     </li>
     <li>
      <a href="../micro_view.html">
       <img src="../skins/arkologik/images/plusminus/view.png" title="View a Topo Surface" class="med" />
      </a>
      <label>
       Topo Surfaces
      </label>
      <a href="../search/key/18/all.html">
       <img src="../skins/arkologik/images/plusminus/view_mag.png" title="Search Topo Surface" class="med" />
      </a>
     </li>
     <li>
      <a href="../micro_view.html">
       <img src="../skins/arkologik/images/plusminus/view.png" title="View a PMP" class="med" />
      </a>
      <label>
       PMPs
      </label>
      <a href="../search/key/15/all.html">
       <img src="../skins/arkologik/images/plusminus/view_mag.png" title="Search PMP" class="med" />
      </a>
     </li>
    </ul>
   </div>
   <!-- MAIN CONTENT (IN COLUMNS) -->
   <div id="main" class="main_mcrview">
    <div id="record_nav" class="record_nav">
     <div id="record_upper">
      <div class="record_upper_left">
       <div id="WPLink">
        <a href="../ https://chersonesos.la.utexas.edu.html" target="_blank">
         Search linked Wordpress for this item
        </a>
       </div>
       <div id="record_jumper">
        <div id="itemval_jumper">
         <form method="get" id="select_itemval" action="/chersonesos/ark/micro_view.php">
          <fieldset>
           <label>
            Context
           </label>
           <script>
            $(document).ready( function() {
                    console.log('loading');
                    $.getJSON(
                        '../itemlist/cxt_cd',
                        function(availablekeys) {
                            $( "#jumper_input" ).autocomplete({
                              source: availablekeys["itemkeys"],
                              select: function( event, ui ) {
                                window.location.href = 'https://n2t.net/ark:/87610/t66h2r/cxt_cd/' + ui.item.value;
                              }
                            })  
                        }
                    ).fail(function(jqxhr, textStatus, error ) {
                        var err = textStatus + ", " + error;
                        console.log( "Request Failed: " + err )
                    })
                  });
           </script>
           <input id="jumper_input" type="text" name="cxt_cd" value="" />
           <input type="hidden" name="item_key" value="cxt_cd" />
          </fieldset>
         </form>
        </div>
       </div>
      </div>
     </div>
     <div id="record_lower">
      <div id="permalink">
       <span>
        <label>
         Archival Resource Key:
        </label>
        <a href="http://n2t.net/ark:/87610/t66h2r/cxt_cd/CH05SR_639">
         ark:/87610/t66h2r/cxt_cd/CH05SR_639
        </a>
       </span>
      </div>
      <ul id="record_nav">
       <li>
        <a href="../cxt_cd/CH05SR_638.html" class="chevrons">
         &lt;&lt;
        </a>
       </li>
       <li class="current">
        CH05SR
       </li>
       <li class="current">
        639
       </li>
       <li class="current">
        Positive
       </li>
       <li>
        <a href="../cxt_cd/CH05SR_640.html" class="chevrons">
         &gt;&gt;
        </a>
       </li>
      </ul>
      <ul id="record_refresh">
       <li>
        <a href="../micro_view.html" class="refresh" title="Refresh">
         &nbsp;
        </a>
       </li>
      </ul>
      <ul id="record_admin">
      </ul>
     </div>
    </div>
    <div id="column-main_column" class="primary_col">
     <div id="cxt_descframe_frame" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Description
       </h4>
      </div>
      <div id="cxt_su_description" class="frm_subform">
       <ul>
        <li class="row">
         <label class="form_label">
          Old Context Code
         </label>
         <span class="data">
          CH05SR0639
         </span>
        </li>
        <li class="row">
         <label class="form_label">
          Definition
         </label>
         <span class="data">
          Floor 3 in room 37
         </span>
        </li>
        <li class="row">
         <label class="form_label">
          Description
         </label>
         <span class="data">
          Hard-packed earth surface, light brown with yellow inclusions; covers at least the SW half of the room from the wall of rm 30 to the section wall, but could not be followed in the NW part of the room (seems to appear under wall 607)
         </span>
        </li>
        <li class="row">
         <label class="form_label">
          Observations
         </label>
         <span class="data">
          Ceramic evidence is heterogeneous, with many small fragments; although latest datable material is 6th-7th c., much of the material is from earlier periods. Of the two coins, one is ancient and the other is of 4th c. date (Constantine)
         </span>
        </li>
        <li style="display:none">
         &nbsp;
        </li>
       </ul>
      </div>
      <div id="colour" class="frm_subform">
       <ul class="field_list">
        <li class="row">
         <label class="form_label">
          Munsell Colour
         </label>
         <span class="data">
          <ul class="attr_list">
           <li>
            <a href="../search/atr/11/47/1.html">
             7/5 YR 4/3
            </a>
            <a target="_blank" href="../concept/attribute/47.html">
             <img src="../skins/arkologik/images/plusminus/help_over.png" alt="info" />
            </a>
           </li>
          </ul>
         </span>
        </li>
       </ul>
      </div>
      <div id="room" class="frm_subform">
       <ul class="field_list">
        <li class="row">
         <label class="form_label">
          Room
         </label>
         <span class="data">
          <ul class="attr_list">
           <li>
            <a href="../search/atr/25/310/1.html">
             37
            </a>
            <a target="_blank" href="../concept/attribute/310.html">
             <img src="../skins/arkologik/images/plusminus/help_over.png" alt="info" />
            </a>
           </li>
          </ul>
         </span>
        </li>
        <li class="row">
         <label class="form_label">
          Area
         </label>
         <span class="data">
          <ul class="attr_list">
           <li>
            <a href="../search/atr/26/319/1.html">
             Courtyard
            </a>
            <a target="_blank" href="../concept/attribute/319.html">
             <img src="../skins/arkologik/images/plusminus/help_over.png" alt="info" />
            </a>
           </li>
          </ul>
         </span>
        </li>
       </ul>
      </div>
     </div>
     <div id="cxt_stratframe_frame" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Matrix
       </h4>
      </div>
      <div id="matrix" class="frm_subform">
       <ul class="matrix_rows">
        <li>
         <ul id="later_tvects" class="matrix_row">
          <li class="lthn" style="background-image: url(/chersonesos/ark//skins/arkologik/images/matrix/later_than_first.png)">
           <a class="ltr" href="../cxt_cd/CH04SR_430.html">
            CH04SR_430
           </a>
           <p class="ltr">
            Cuts
           </p>
          </li>
          <li class="lthn" style="background-image: url(/chersonesos/ark//skins/arkologik/images/matrix/later_than_middle.png)">
           <a class="ltr" href="../cxt_cd/CH05SR_430.html">
            CH05SR_430
           </a>
           <p class="ltr">
            Cuts
           </p>
          </li>
          <li class="lthn" style="background-image: url(/chersonesos/ark//skins/arkologik/images/matrix/later_than_middle.png)">
           <a class="ltr" href="../cxt_cd/CH05SR_592.html">
            CH05SR_592
           </a>
           <p class="ltr">
            Covers
           </p>
          </li>
          <li class="lthn" style="background-image: url(/chersonesos/ark//skins/arkologik/images/matrix/later_than_middle.png)">
           <a class="ltr" href="../cxt_cd/CH05SR_596.html">
            CH05SR_596
           </a>
           <p class="ltr">
            Covers
           </p>
          </li>
          <li class="lthn" style="background-image: url(/chersonesos/ark//skins/arkologik/images/matrix/later_than_middle.png)">
           <a class="ltr" href="../cxt_cd/CH05SR_607.html">
            CH05SR_607
           </a>
           <p class="ltr">
            Covers
           </p>
          </li>
          <li class="lthn" style="background-image: url(/chersonesos/ark//skins/arkologik/images/matrix/later_than_middle.png)">
           <a class="ltr" href="../cxt_cd/CH05SR_620.html">
            CH05SR_620
           </a>
           <p class="ltr">
            Covers
           </p>
          </li>
          <li class="lthn" style="background-image: url(/chersonesos/ark//skins/arkologik/images/matrix/later_than_middle.png)">
           <a class="ltr" href="../cxt_cd/CH05SR_626.html">
            CH05SR_626
           </a>
           <p class="ltr">
            Cuts
           </p>
          </li>
          <li class="lthn" style="background-image: url(/chersonesos/ark//skins/arkologik/images/matrix/later_than_middle.png)">
           <a class="ltr" href="../cxt_cd/CH05SR_628.html">
            CH05SR_628
           </a>
           <p class="ltr">
            Cuts
           </p>
          </li>
          <li class="lthn" style="background-image: url(/chersonesos/ark//skins/arkologik/images/matrix/later_than_middle.png)">
           <a class="ltr" href="../cxt_cd/CH05SR_637.html">
            CH05SR_637
           </a>
           <p class="ltr">
            Covers
           </p>
          </li>
          <li class="lthn" style="background-image: url(/chersonesos/ark//skins/arkologik/images/matrix/later_than_last.png)">
           <a class="ltr" href="../cxt_cd/CH05SR_693.html">
            CH05SR_693
           </a>
           <p class="ltr">
            Covers
           </p>
          </li>
         </ul>
        </li>
        <li>
         <ul class="matrix_row">
          <li class="middle">
           <a href="../#.html">
            CH05SR_639
           </a>
          </li>
         </ul>
        </li>
        <li>
         <ul id="earlier_tvects" class="matrix_row">
          <li class="ethn" style="background-image: url(/chersonesos/ark//skins/arkologik/images/matrix/earlier_than_first.png)">
           <p class="erl">
            Covers
           </p>
           <a href="../cxt_cd/CH05SR_652.html" class="erl">
            CH05SR_652
           </a>
          </li>
          <li class="ethn" style="background-image: url(/chersonesos/ark//skins/arkologik/images/matrix/earlier_than_last.png)">
           <p class="erl">
            Covers
           </p>
           <a href="../cxt_cd/CH05SR_655.html" class="erl">
            CH05SR_655
           </a>
          </li>
         </ul>
        </li>
       </ul>
      </div>
      <div id="cxt_other_matrix" class="frm_subform">
       <ul id="fields" class="hz_list">
        <li class="row">
         <h5>
          Same As
         </h5>
         <p>
          None linked.
         </p>
        </li>
       </ul>
      </div>
     </div>
     <div id="cxt_interp" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Interpretation
       </h4>
      </div>
      <ul>
       <li class="recordarea">
        <ul>
         <li class="row">
          <label class="form_label">
           Interpretation
          </label>
          <span class="data">
           Beaten-earth floor of Early Byzantine phase, or perhaps trample and abandonment layer created before the use of the area in the Early Byzantine phase
          </span>
         </li>
         <li class="row">
          <label class="form_label">
           Interpreted By
          </label>
          <span class="data">
           <ul class="actor_list">
            <li>
             DVD
            </li>
           </ul>
          </span>
         </li>
        </ul>
       </li>
       <li class="recordarea">
        <ul>
         <li class="row">
          <label class="form_label">
           Interpretation
          </label>
          <span class="data">
           This floor is almost certainly contemporary with the use of the clay-lined hearth in this area, although it is possible that it accumulated during the use of the space in the Early Byzantine period; in that case, perhaps only the final use of the hearth was contemporary. In any case, it seems most likely that the soil accumulated over a long period of time, and that the surface we identified was its last use-surface
          </span>
         </li>
         <li class="row">
          <label class="form_label">
           Interpreted By
          </label>
          <span class="data">
           <ul class="actor_list">
            <li>
             ATR
            </li>
           </ul>
          </span>
         </li>
        </ul>
       </li>
      </ul>
     </div>
     <div id="finds" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Finds
       </h4>
      </div>
      <ul class="field_list">
       <li class="row">
        <span class="data">
         <ul class="attr_list">
          <li>
           <a href="../search/atr/12/117/1.html">
            Pot
           </a>
           <a target="_blank" href="../concept/attribute/117.html">
            <img src="../skins/arkologik/images/plusminus/help_over.png" alt="info" />
           </a>
          </li>
          <li>
           <a href="../search/atr/12/119/1.html">
            Metal
           </a>
           <a target="_blank" href="../concept/attribute/119.html">
            <img src="../skins/arkologik/images/plusminus/help_over.png" alt="info" />
           </a>
          </li>
          <li>
           <a href="../search/atr/12/115/1.html">
            Tile
           </a>
           <a target="_blank" href="../concept/attribute/115.html">
            <img src="../skins/arkologik/images/plusminus/help_over.png" alt="info" />
           </a>
          </li>
          <li>
           <a href="../search/atr/12/120/1.html">
            Bone
           </a>
           <a target="_blank" href="../concept/attribute/120.html">
            <img src="../skins/arkologik/images/plusminus/help_over.png" alt="info" />
           </a>
          </li>
          <li>
           <a href="../search/atr/12/116/1.html">
            Glass
           </a>
           <a target="_blank" href="../concept/attribute/116.html">
            <img src="../skins/arkologik/images/plusminus/help_over.png" alt="info" />
           </a>
          </li>
         </ul>
        </span>
       </li>
      </ul>
     </div>
     <div id="formationtype" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Formation Processes
       </h4>
      </div>
      <ul class="field_list">
       <li class="row">
        <label class="form_label">
         Formation Type
        </label>
        <span class="data">
         <ul class="attr_list">
          <li>
           <a href="../search/atr/4/8/1.html">
            Construction
           </a>
           <a target="_blank" href="../concept/attribute/8.html">
            <img src="../skins/arkologik/images/plusminus/help_over.png" alt="info" />
           </a>
          </li>
         </ul>
        </span>
       </li>
       <li class="row">
        <label class="form_label">
         Formation (Intentional)
        </label>
        <span class="data">
         <ul class="attr_list">
          <li>
           <a href="../search/atr/3/259/1.html">
            Intentional
           </a>
           <a target="_blank" href="../concept/attribute/259.html">
            <img src="../skins/arkologik/images/plusminus/help_over.png" alt="info" />
           </a>
          </li>
         </ul>
        </span>
       </li>
       <li class="row">
        <label class="form_label">
         Formation (Natural)
        </label>
        <span class="data">
         <ul class="attr_list">
          <li>
           <a href="../search/atr/2/261/1.html">
            Artificial
           </a>
           <a target="_blank" href="../concept/attribute/261.html">
            <img src="../skins/arkologik/images/plusminus/help_over.png" alt="info" />
           </a>
          </li>
         </ul>
        </span>
       </li>
       <li class="row">
        <label class="form_label">
         Preservation
        </label>
        <span class="data">
         <ul class="attr_list">
          <li>
           <a href="../search/atr/6/14/1.html">
            Good
           </a>
           <a target="_blank" href="../concept/attribute/14.html">
            <img src="../skins/arkologik/images/plusminus/help_over.png" alt="info" />
           </a>
          </li>
         </ul>
        </span>
       </li>
       <li class="row">
        <label class="form_label">
         Stratigraphic Reliability
        </label>
        <span class="data">
         <ul class="attr_list">
          <li>
           <a href="../search/atr/9/266/1.html">
            Good Reliability
           </a>
           <a target="_blank" href="../concept/attribute/266.html">
            <img src="../skins/arkologik/images/plusminus/help_over.png" alt="info" />
           </a>
          </li>
         </ul>
        </span>
       </li>
      </ul>
     </div>
     <div id="faunal_ass_frame" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Faunal Assemblage
       </h4>
      </div>
      <script language="javascript" type="text/javascript" src="../lib/js/flot/jquery.flot.js">
      </script>
      <script language="javascript" type="text/javascript" src="../lib/js/flot/jquery.flot.pie.js">
      </script>
      <div id="div-faunal_ass" class="frm_subform">
       <ul>
        <li class="row">
         <span>
          There are no results for this record
         </span>
        </li>
       </ul>
      </div>
      <div id="div-arch_asm" class="frm_subform">
       <script src="../lib/js/jquery.tablesorter.min.js">
       </script>
       <script src="../lib/js/jquery.tablesorter.widget-editable.js">
       </script>
      </div>
      <script>
       $("#arch_asm_table")
    .tablesorter({
    });
    
$("table .assemblage")
    .tablesorter({
    });
      </script>
     </div>
     <script language="javascript" type="text/javascript" src="../lib/js/flot/jquery.flot.js">
     </script>
     <script language="javascript" type="text/javascript" src="../lib/js/flot/jquery.flot.pie.js">
     </script>
     <div id="div-fish_species" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Fish Species Assemblage
       </h4>
      </div>
      <ul>
       <li class="row">
        <span>
         There are no results for this record
        </span>
       </li>
      </ul>
     </div>
     <script language="javascript" type="text/javascript" src="../lib/js/flot/jquery.flot.js">
     </script>
     <script language="javascript" type="text/javascript" src="../lib/js/flot/jquery.flot.pie.js">
     </script>
     <div id="div-birds_species" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Birds Species Assemblage
       </h4>
      </div>
      <ul>
       <li class="row">
        <span>
         There are no results for this record
        </span>
       </li>
      </ul>
     </div>
     <div id="ceramic_ass_frame" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Ceramic Assemblage
       </h4>
      </div>
      <script language="javascript" type="text/javascript" src="../lib/js/flot/jquery.flot.js">
      </script>
      <script language="javascript" type="text/javascript" src="../lib/js/flot/jquery.flot.pie.js">
      </script>
      <div id="div-ceramic_class" class="frm_subform">
       <h5>
        Total = 81
       </h5>
       <div>
        <label class="form_label">
         Ceramic Class
        </label>
        <table class="assemblage">
         <tr>
          <th>
          </th>
          <th>
           Total
          </th>
         </tr>
         <tr>
          <td>
           Amphora
          </td>
          <td>
           35
          </td>
         </tr>
         <tr>
          <td>
           Cookware
          </td>
          <td>
           13
          </td>
         </tr>
         <tr>
          <td>
           Fineware
          </td>
          <td>
           33
          </td>
         </tr>
        </table>
        <script type="text/javascript">
         jQuery(document).ready(function () {
                                        var data = [{label: "Amphora", data: 35},{label: "Cookware", data: 13},{label: "Fineware", data: 33},];
                                        jQuery.plot(jQuery("#chart42"), data, {
                                             series: {
                                                pie: {
                                                    show: true,
                                                    combine: {
                                                        color: '#999',
                                                        threshold: 0.1
                                                    }
                                                }
                                             },
                                             legend: {
                                                show: false
                                             },
                                        });
                                    });
        </script>
        <div id="chart42" style="width:400px; height:250px">
        </div>
       </div>
      </div>
      <div id="div-ceramic_type" class="frm_subform">
       <h5>
        Total = 81
       </h5>
       <div>
        <label class="form_label">
         Ceramic Type
        </label>
        <table class="assemblage">
         <tr>
          <th>
          </th>
          <th>
           Total
          </th>
         </tr>
         <tr>
          <td>
           Unidentified Hellenistic and Roman amphora
          </td>
          <td>
           4
          </td>
         </tr>
         <tr>
          <td>
           Sinope
          </td>
          <td>
           2
          </td>
         </tr>
         <tr>
          <td>
           Colchis
          </td>
          <td>
           3
          </td>
         </tr>
         <tr>
          <td>
           Light clay (Heraklea, Sinope)
          </td>
          <td>
           1
          </td>
         </tr>
         <tr>
          <td>
           Red clay (Zeest 72, 76, 80)
          </td>
          <td>
           2
          </td>
         </tr>
         <tr>
          <td>
           Class 1
          </td>
          <td>
           1
          </td>
         </tr>
         <tr>
          <td>
           Class 2 ("carrot")
          </td>
          <td>
           5
          </td>
         </tr>
         <tr>
          <td>
           ADSV, type V
          </td>
          <td>
           3
          </td>
         </tr>
         <tr>
          <td>
           Class 18 (with funnel rim) (LRA 2-Riley)
          </td>
          <td>
           1
          </td>
         </tr>
         <tr>
          <td>
           Unidentified amphora
          </td>
          <td>
           13
          </td>
         </tr>
         <tr>
          <td>
           Handmade cookware
          </td>
          <td>
           13
          </td>
         </tr>
         <tr>
          <td>
           Unidentified plain fineware
          </td>
          <td>
           18
          </td>
         </tr>
         <tr>
          <td>
           Red-slip
          </td>
          <td>
           11
          </td>
         </tr>
         <tr>
          <td>
           Black gloss (pale and red clay)
          </td>
          <td>
           4
          </td>
         </tr>
        </table>
       </div>
      </div>
      <script language="javascript" type="text/javascript" src="../lib/js/flot/jquery.flot.js">
      </script>
      <script language="javascript" type="text/javascript" src="../lib/js/flot/jquery.flot.pie.js">
      </script>
      <div id="div-ceramic_date" class="frm_subform">
       <h5>
        Total = 81
       </h5>
       <div>
        <label class="form_label">
         Ceramic Date
        </label>
        <table class="assemblage">
         <tr>
          <th>
          </th>
          <th>
           Total
          </th>
         </tr>
         <tr>
          <td>
           Hellenistic/Roman
          </td>
          <td>
           4
          </td>
         </tr>
         <tr>
          <td>
           1st c. BC-2nd c. AD
          </td>
          <td>
           1
          </td>
         </tr>
         <tr>
          <td>
           2nd-3rd c. AD
          </td>
          <td>
           2
          </td>
         </tr>
         <tr>
          <td>
           5th-7th c. AD
          </td>
          <td>
           10
          </td>
         </tr>
         <tr>
          <td>
           Roman (Ceramic date)
          </td>
          <td>
           10
          </td>
         </tr>
         <tr>
          <td>
           3rd-4th c. AD
          </td>
          <td>
           1
          </td>
         </tr>
         <tr>
          <td>
           Hellenistic (Ceramic date)
          </td>
          <td>
           9
          </td>
         </tr>
        </table>
        <script type="text/javascript">
         jQuery(document).ready(function () {
                                        var data = [{label: "Hellenistic/Roman", data: 4},{label: "1st c. BC-2nd c. AD", data: 1},{label: "2nd-3rd c. AD", data: 2},{label: "5th-7th c. AD", data: 10},{label: "Roman (Ceramic date)", data: 10},{label: "3rd-4th c. AD", data: 1},{label: "Hellenistic (Ceramic date)", data: 9},];
                                        jQuery.plot(jQuery("#chart45"), data, {
                                             series: {
                                                pie: {
                                                    show: true,
                                                    combine: {
                                                        color: '#999',
                                                        threshold: 0.1
                                                    }
                                                }
                                             },
                                             legend: {
                                                show: false
                                             },
                                        });
                                    });
        </script>
        <div id="chart45" style="width:400px; height:250px">
        </div>
       </div>
      </div>
     </div>
     <div id="sfi_xmiconf_xmi_viewer" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Linked Special Finds
       </h4>
      </div>
      <ul id="existing-sfi" class="xmi_list">
       <li>
        <h5 style="width: 100%">
         Special Find:
         <a href="../sfi_cd/CH05SR_3256.html">
          CH05SR_3256
         </a>
        </h5>
        <ul id="fields-for-CH05SR_3256" class="xmi_field">
         <li>
          <label class="form_label">
           Short Description
          </label>
          <span class="data">
           coin
          </span>
         </li>
         <li>
          <label class="form_label">
           Image(s)
          </label>
          <span class="data">
           <a href="../data/files/webthumb_2459.jpg" class="imagebox" title="CH05SR_3256">
            <img src="../data/files/arkthumb_2459.jpg" alt="file_image" />
           </a>
          </span>
         </li>
        </ul>
       </li>
       <li>
        <h5 style="width: 100%">
         Special Find:
         <a href="../sfi_cd/CH05SR_3257.html">
          CH05SR_3257
         </a>
        </h5>
        <ul id="fields-for-CH05SR_3257" class="xmi_field">
         <li>
          <label class="form_label">
           Short Description
          </label>
          <span class="data">
           (disintegrated) object
          </span>
         </li>
         <li>
          <label class="form_label">
           Image(s)
          </label>
          <span class="data">
           <a href="../data/files/webthumb_2462.jpg" class="imagebox" title="CH05SR_3257">
            <img src="../data/files/arkthumb_2462.jpg" alt="file_image" />
           </a>
          </span>
         </li>
        </ul>
       </li>
       <li>
        <h5 style="width: 100%">
         Special Find:
         <a href="../sfi_cd/CH05SR_3270.html">
          CH05SR_3270
         </a>
        </h5>
        <ul id="fields-for-CH05SR_3270" class="xmi_field">
         <li>
          <label class="form_label">
           Short Description
          </label>
          <span class="data">
           coin
          </span>
         </li>
         <li>
          <label class="form_label">
           Image(s)
          </label>
          <span class="data">
           <a href="../data/files/webthumb_2481.jpg" class="imagebox" title="CH05SR_3270">
            <img src="../data/files/arkthumb_2481.jpg" alt="file_image" />
           </a>
          </span>
         </li>
        </ul>
       </li>
      </ul>
     </div>
     <div id="smp_xmiconf_xmi_viewer" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Linked Samples
       </h4>
      </div>
      <ul>
       <li class="row">
        <label class="form_label">
         Sample
        </label>
        <span class="value">
         No attached items.
        </span>
       </li>
      </ul>
     </div>
     <div id="div-cxt_xmi_smp" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Botanical Assemblage
       </h4>
      </div>
      <script src="../lib/js/jquery.tablesorter.min.js">
      </script>
      <script src="../lib/js/jquery.tablesorter.widget-editable.js">
      </script>
     </div>
     <script>
      $("#arch_asm_table")
    .tablesorter({
    });
    
$("table .assemblage")
    .tablesorter({
    });
     </script>
     <div id="skl_xmiconf_xmi_viewer" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Skeletal Remains
       </h4>
      </div>
      <ul>
       <li class="row">
        <label class="form_label">
         Skeletal Remain
        </label>
        <span class="value">
         No attached items.
        </span>
       </li>
      </ul>
     </div>
     <div id="mcw_xmiconf_xmi_viewer" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Microwear Analysis
       </h4>
      </div>
      <ul>
       <li class="row">
        <label class="form_label">
         Microwear Record
        </label>
        <span class="value">
         No attached items.
        </span>
       </li>
      </ul>
     </div>
     <div id="cxt_rec_sheet_display" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Recording Sheet
       </h4>
      </div>
      <ul>
       <li class="file_thumbs">
        <a href="../data/files//webthumb_8771.jpg" class="imagebox" title="ICA/ChersonesosSouth/ChersonesosSouth_ARK/text_documentation/scanned_completed_recording_sheets/cxt_CH05SR_639_m.pdf">
         <img src="../data/files/arkthumb_8771.jpg" alt="file_image" />
        </a>
        <a href="http://web.corral.tacc.utexas.edu/ICA/ChersonesosSouth/ChersonesosSouth_ARK/text_documentation/scanned_completed_recording_sheets/cxt_CH05SR_639_m.pdf" alt="ICA/ChersonesosSouth/ChersonesosSouth_ARK/text_documentation/scanned_completed_recording_sheets/cxt_CH05SR_639_m.pdf">
         <img src="../skins/arkologik/images/results/download_sml.png" alt="[Download]" title="Download" class="med" />
        </a>
       </li>
      </ul>
     </div>
    </div>
    <div id="column-second_column" class="secondary_col">
     <div id="period" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Date
       </h4>
      </div>
      <ul class="field_list">
       <li class="row">
        <label class="form_label">
         Period
        </label>
        <span class="data">
         <ul class="attr_list">
          <li>
           <a href="../search/atr/8/24/1.html">
            Early Byzantine (5th-7th century)
           </a>
           <a target="_blank" href="../concept/attribute/24.html">
            <img src="../skins/arkologik/images/plusminus/help_over.png" alt="info" />
           </a>
          </li>
         </ul>
        </span>
       </li>
       <li style="display:none">
        &nbsp;
       </li>
      </ul>
     </div>
     <div id="cxt_recframe_frame" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Record Status Flags
       </h4>
      </div>
      <div id="div-recordmeta" class="frm_subform">
       <ul>
        <li class="row">
         <label class="form_label">
          Closed
         </label>
         <img src="../skins/arkologik/images/onoff/chk_on.png" alt="on/off_switch" />
        </li>
       </ul>
      </div>
      <div id="div-recordmeta" class="frm_subform">
       <ul>
        <li class="row">
         <label class="form_label">
          Completed
         </label>
         <img src="../skins/arkologik/images/onoff/chk_on.png" alt="on/off_switch" />
        </li>
       </ul>
      </div>
     </div>
     <div id="cxt_events" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Events
       </h4>
      </div>
      <ul id="events" class="hz_list">
       <li>
        <h5>
         Excavator
        </h5>
        <span class="data">
         <ul class="actor_list">
          <li>
           DVD
          </li>
         </ul>
        </span>
        <h5>
         Date Excavated
        </h5>
        <span class="data">
         25-7-2005
        </span>
       </li>
       <li>
        <h5>
         Verified by
        </h5>
        <span class="data">
         ATR
        </span>
        <h5>
         Verified on
        </h5>
        <span class="data">
         8-7-2006
        </span>
       </li>
       <li>
        <h5>
         Entered By
        </h5>
        <span class="data">
         <ul class="actor_list">
          <li>
           DVD
          </li>
         </ul>
        </span>
       </li>
      </ul>
     </div>
     <div id="cxt_spat_display" class="mapview mc_subform">
      <div class="sf_nav">
       <h4>
        Spatial Data
       </h4>
      </div>
      <a id="export-png" href="../#.html">
      </a>
      <a id="image-download" href="../#.html" download="map.png">
      </a>
      <div id="popup">
      </div>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.2.1/proj4.js" type="text/javascript">
      </script>
      <script type="text/javascript">
       proj4.defs("EPSG:27700","+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +towgs84=446.448,-125.157,542.06,0.15,0.247,0.842,-20.489 +units=m +no_defs");
    
    proj4.defs("EPSG:32633","+proj=utm +zone=33 +datum=WGS84 +units=m +no_defs");
    
    proj4.defs("EPSG:32632","+proj=utm +zone=32 +datum=WGS84 +units=m +no_defs");
    
    proj4.defs("EPSG:32636","+proj=utm +zone=36 +datum=WGS84 +units=m +no_defs");
    var center = [1161146.542370356,4500173.095768951];

    view =  new ol.View({
        center: center,
        zoom: '',
        projection: 'EPSG:32636',
    });
    
    var container = document.getElementById('popup');
    var content = document.getElementById('popup-content');

    var overlay = new ol.Overlay({
        element: container,
        map: map1,
    });
    
    var map1 = new ol.Map({
        controls: ol.control.defaults({attribution: false, compass:false}).extend([
            new ol.control.ScaleLine(),
        ]),
        interactions: ol.interaction.defaults(),
        // Use the canvas renderer because it's currently the fastest
        renderer: 'canvas',
        target: 'cxt_spat_display',
        view: view,
        overlays: [overlay],
    });

    window.styleCache={};

    $(document).ready(function() {
        map1.updateSize();
        map1.on('moveend',function(){
            var center = map1.getView().get('center');
            var extents = map1.getView().get('extents');
            centerstring = '['+center.toString()+']';
            var zoom = map1.getView().getZoom();
            console.log(zoom);
            console.log(centerstring);
            $.ajax({
                method: "POST",
                url: "/chersonesos/ark/api.php?req=update_sessionmap",
                data: { center: centerstring, zoomlevel: zoom, map_view: "home", extents:extents  }
            })
            .done(function( msg ) {
                console.log("Session Updated");
            });
        });
    });var osmlayer = new ol.layer.Tile({
        source: new ol.source.OSM()
      });

osmlayer.set('name', 'osmlayer');

map1.addLayer(osmlayer);

osmlayer.setVisible( false );

document.getElementById('export-png').addEventListener('click', function() {
            var mapCanvas = document.createElement('canvas');
            var size = map1.getSize();
            mapCanvas.width = size[0];
            mapCanvas.height = size[1];
            var mapContext = mapCanvas.getContext('2d');

            Array.prototype.forEach.call(document.querySelectorAll('.ol-viewport canvas'), function(canvas) {
                console.log(canvas);
                console.log(canvas.width);

              if (canvas.width > 0) {
                var opacity = canvas.parentNode.style.opacity;
                mapContext.globalAlpha = opacity === '' ? 1 : Number(opacity);
                //var transform = canvas.style.transform;
                // Get the transform parameters from the style's transform matrix
                //var matrix = transform.match(/^matrix\(([^\(]*)\)$/)[1].split(',').map(Number);
                // Apply the transform to the export map context
                //CanvasRenderingContext2D.prototype.setTransform.apply(mapContext, matrix);
                mapContext.drawImage(canvas, 0, 0);
              }
            });
            if (navigator.msSaveBlob) {
              // link download attribuute does not work on MS browsers
              navigator.msSaveBlob(mapCanvas.msToBlob(), 'map.png');
            } else {
              var link = document.getElementById('image-download');
              link.href = mapCanvas.toDataURL();
              link.click();
            }
          
          map1.renderSync();
        })




    var first2 = true;
    var parseResponse = function(response) {
        //this is where we style on a per feature basis
        console.log("parseResponse");
        console.log(response);
        features = layer2Source.readFeatures(response);
        console.log(features);
        features.forEach(function(e,i,a){
            var properties = e.getProperties();
            e.setProperties(properties);
        });
        layer2Source.addFeatures(features);
    
    };

    var layer2Source = new ol.source.Vector({
        format: new ol.format.GeoJSON(),
        loader: function(extent, resolution, projection) {
            var url = '../data/mapping/cxt_pg.geojson';
            jQuery.ajax({
                url: url,
                contentType: 'text/xml',
                data: '&lt;wfs:GetFeature service="WFS" version="1.1.0" outputFormat="text/javascript" xmlns:wfs="http://www.opengis.net/wfs" xmlns:ogc="http://www.opengis.net/ogc"&gt; &lt;wfs:Query typeName="final_plan" srsName="epsg:4326"&gt;&lt;ogc:Box&gt;&lt;ogc:coordinates&gt;' + extent.join(',') + ',epsg:4326&lt;/ogc:coordinates&gt;&lt;/ogc:box&gt;&lt;/wfs:query&gt;&lt;/wfs:getfeature&gt;',
                type: 'POST',
                dataType: 'jsonp',
            });
        },
        strategy: ol.loadingstrategy.bbox,
    });

    var layer2 = new ol.layer.Vector({
        source:layer2Source,
    });
    layer2.setStyle(function(feature, resolution) {

        var symbol = feature.get('symbol');

        if (!symbol) {
          symbol = 99;
        }

        cutoff = 0.04;

        if (resolution > cutoff){
        	symbol = "large" + symbol;
        } else {
        	symbol = "small" + symbol;
        }

        if (!window.styleCache[symbol]) {
          switch(symbol) {
              case "small2":
                window.styleCache[symbol] = 
                [
                new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: "#ffffff",
                        width: 0.5
                    }),
                    fill: new ol.style.Fill({
                        color: "#000000",
                    })
                })
                ]
            break;
            case "small7":
            case "small8":
            case "small9":
            case "small10":
            case "small11":
            case "small12":
            case "small13":
                window.styleCache[symbol] =
                [new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: "#ffffff",
                        width: 0.1
                    }),
                    fill: new ol.style.Fill({
                        color: "#cccccc",
                    })
                
                })];
            break;
            case "large2":
            case "large7":
            case "large8":
            case "large9":
            case "large10":
            case "large11":
            case "large12":
            case "large13":
                window.styleCache[symbol] = [];
            break;
            default:
		window.styleCache[symbol] = [
                    new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: "#ffffff",
                        width: 1
                    }),
                    fill: new ol.style.Fill({
                        color: "#00ffff",
                    })
                })];                
          }
          
        }

        return window.styleCache[symbol];
      });
    
    layer2.set('name', 'cxt_pg');

    map1.addLayer(layer2);layer2.setVisible(true);layer2.setVisible(true);
    var layer1Source = new ol.source.Vector({
        projection: '',
        url: '../data/mapping/final_plan.geojson',
        format: new ol.format.GeoJSON() });
    
    var layer1 = new ol.layer.Vector({ source: layer1Source });
layer1.setStyle(function(feature, resolution) {

        var symbol = feature.get('symbol');

        if (!symbol) {
          symbol = 99;
        }

        cutoff = 0.04;

        if (resolution > cutoff){
        	symbol = "large" + symbol;
        } else {
        	symbol = "small" + symbol;
        }

        if (!window.styleCache[symbol]) {
          switch(symbol) {
              case "small15":
                window.styleCache[symbol] = 
                [
                new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: "#000000",
                        width: 0.5
                    })
                }),
                new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: "#000000",
                        width: 5,
                        lineDash: [1, 9999],
                        lineCap: "butt"
                    })
                }),
                new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: "#000000",
                        width: 2,
                        lineDash: [4, 9999],
                        lineCap: "butt"
                    })
                }),
                new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: "#000000",
                        width: 3,
                        lineDash: [3, 9999],
                        lineCap: "butt"
                    })
                }),
                new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: "#000000",
                        width: 4,
                        lineDash: [2, 9999],
                        lineCap: "butt"
                    })
                }),
                new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: "#000000",
                        width: 1,
                        lineDash: [5, 9999],
                        lineCap: "butt"
                    })
                })
                ]
            break;
            case "small19":
                window.styleCache[symbol] =
                [new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: "#999999",
                        lineDash: [1,1],
                        lineCap: "butt",
                        width: 0.5
                    })
                })];
            break;
            case "small18":
            case "small8":
            case "small8":
                window.styleCache[symbol] =
                [new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: "#000000",
                        width: 0.5
                    })
                })];
            break;
            case "small6":
            case "small9":
            case "small13":
                window.styleCache[symbol] =
                [new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: "#555555",
                        width: 0.2,
                        lineDash: [1,1]
                    })
                })];
            break;
            case "large15":
            case "large6":
            case "large9":
            case "large13":
            case "large18":
            case "large19":
                window.styleCache[symbol] = [];
            break;
            case "small21":
            case "large21":
            case "small12":
            case "large12":
            	window.styleCache[symbol] = [new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: "#000000",
                        width: 1
                    })
                })];
            break;
            default:
				window.styleCache[symbol] = [new ol.style.Style({
                    stroke: new ol.style.Stroke({
                        color: "#000000",
                        width: 0.1
                    })
                })];                
          }
          
        }

        return window.styleCache[symbol];
      });

    layer1.set('name', 'cxt_pl');

    map1.addLayer(layer1);layer1.setVisible(true);
    var layerconf_field_cxt_schmSource = new ol.source.Vector({
        projection: 'epsg:32636',
        url: '../data/mapping/cxt_schm.geojson',
        format: new ol.format.GeoJSON() });
    
    var layerconf_field_cxt_schm = new ol.layer.Vector({ source: layerconf_field_cxt_schmSource });
layerconf_field_cxt_schm.setStyle(
        new ol.style.Style({
            fill: new ol.style.Fill({
                color: 'rgba(255, 255, 255, 0.0)'
            }),
            stroke: new ol.style.Stroke({
                color: 'rgba(250, 250, 250, 0.8)',
                width: 0.1
            }),
            image: new ol.style.Circle({
                radius: 0,
                fill: new ol.style.Fill({
                    color: '#ff561d'
                })
            })
        }));
layerconf_field_cxt_schm.set('selectable', true);

    firstconf_field_cxt_schm = true;
    map1.getLayers().forEach(function(i,e,a){
        if (i.get('name')=='Context Schema'){
            var source = i.getSource();
            source.on('change', function (event) {
                if (source.getState() == 'ready') {
                    if(firstconf_field_cxt_schm){
                        map1.updateSize();
                        map1.getView().fit(source.getExtent(),  map1.getSize());
                        map1.render();
                        firstconf_field_cxt_schm = false;
                    }
                }
            });
        }
    });
    layerconf_field_cxt_schm.set('name', 'Context Schema');

    map1.addLayer(layerconf_field_cxt_schm);layerconf_field_cxt_schm.setVisible(true);
    var overlayStyle = (function(){
        var focusstyle = new ol.style.Style({
            image: new ol.style.Circle({
                radius: 6,
                fill: new ol.style.Fill({color: 'rgba(255, 255, 0, 0.6)'}),
                stroke: new ol.style.Stroke({color: '#e29446', width: 1})
            }),
            fill: new ol.style.Fill({color: 'rgba(255, 255, 0, 0.6)'}),
            stroke: new ol.style.Stroke({color: '#e29446', width: 2}),
            zIndex: 3
        });
        
        var style = new ol.style.Style({
            image: new ol.style.Circle({
                radius: 6,
                stroke: new ol.style.Stroke({color: '#e29446', width: 1})
            }),
            stroke: new ol.style.Stroke({color: '#e29446', width: 2}),
            zIndex: 2
        });
        return function(feature, resolution) {
            if ( typeof ark_id !== 'undefined' ) {
                if(feature.getProperties().ark_id.toUpperCase() == ark_id){
                    return [focusstyle];
                } else {
                    return [style];
                }
            } else {
                return [style];
            }
        };
    })();

    
    var multiSelectOverlay = new ol.layer.Vector({
        source: new ol.source.Vector(),
        map: map1,
        style: new ol.style.Style({
            image: new ol.style.Circle({
                radius: 6,
                fill: new ol.style.Fill({color: 'rgba(255, 255, 255, 0.6)'}),
                stroke: new ol.style.Stroke({color: '#e29446', width: 1})
            }),
            fill: new ol.style.Fill({color: 'rgba(255, 86, 29, 0.6)'}),
            stroke: new ol.style.Stroke({color: '#e29446', width: 2})
        }),
        projection:'EPSG:32636',
    });
    multiSelectOverlay.set('name', "multiSelectOverlay");

    multiSelectOverlay.setStyle(overlayStyle);

    var collection = new ol.Collection();
    var iframes = {};
    var iframeids = [];

    var cycleFeatureData = function(iframeids, iframes, direction) {
        console.log(iframeids);
        var index = iframeids.indexOf(ark_id);
        
        if(direction!='back'){
            index += 1;
        } else {
            index -= 1;
        }
        if(index<0){
            index=iframeids.length-1;
        }
        if(index>iframeids.length-1){
            index=0;
        }
        console.log(index);
        
        iframes[ark_id].style.display = 'none';
        ark_id = iframeids[index];
        
        multiSelectOverlay.setStyle(overlayStyle);
        
        iframes[ark_id].style.display = 'inline';
        
        var titleElem = document.getElementById('overlayTitleElem');
        titleElem.href='/chersonesos/ark//micro_view.php?item_key=cxt_cd&cxt;_cd='+ark_id;

        titleElem.innerHTML = '&lt;h5&gt;Context '+ark_id+'&lt;/h5&gt;';

        iframes[ark_id].height = iframes[ark_id].contentWindow.document.body.scrollHeight + "px";
    }

    var displayFeatureInfo = function(pixel) {
        $('#subforms').append($(overlay.getElement()).show());
        var alreadySelected = map1.hasFeatureAtPixel(pixel, {
            layerFilter: function(layer) {
                return layer.get('name') == 'multiSelectOverlay' 
            }
        });
        var selectableLayer = map1.hasFeatureAtPixel(pixel, {
            layerFilter: function(layer) {
                return layer.get('selectable')
            }
        });
        if( alreadySelected ){
            console.log('selected');
            cycleFeatureData(iframeids, iframes, 'fore')
        } else if( selectableLayer ){
            overlay.getElement().innerHTML = '&lt;img class="loading" src="/chersonesos/ark//skins/arkologik/images/lightbox/loading.gif"&gt;&lt;/img&gt;';
            overlay.getElement().style.display = 'block';
            var data = document.createElement('div');

            iframes = {};
            iframeids = [];

            multiSelectOverlay.getSource().clear();

            map1.forEachFeatureAtPixel(pixel, function(feature, layer) {
                ark_id = feature.getProperties().ark_id.toUpperCase();
                console.log(ark_id);
                iframes[ark_id] = document.createElement('iframe');
                iframes[ark_id].setAttribute("id","popupiframe"+ark_id);
                iframes[ark_id].setAttribute("scrolling","yes");
                iframes[ark_id].setAttribute("src","api.php?req=transcludeSubform&item;_key=cxt_cd&cxt;_cd="+ark_id+"&sf;_conf=cxt_map_pop_conf&sf;_key=cxt_cd&sf;_val="+ark_id+"");
                iframes[ark_id].style.display = 'none';
                iframes[ark_id].onload= function(){
                    $('.loading').hide();
                    iframes[ark_id].height = iframes[ark_id].contentWindow.document.body.scrollHeight + "px";
                };
                if(iframeids.indexOf(ark_id)==-1){
                    iframeids.push(ark_id);
                };
                data.appendChild(iframes[ark_id]);
                multiSelectOverlay.getSource().addFeature(feature);
            });
            
            
            iframeids.sort();
            
            var titlebar = document.createElement('div');
            var backbtn = document.createElement('a');
            backbtn.id='backbtn';
            backbtn.innerHTML = '&lt;&lt;';
            backbtn.onclick = function(){cycleFeatureData(iframeids, iframes, 'back')};
            var forebtn = document.createElement('a');
            forebtn.id='forebtn';
            forebtn.innerHTML = '&gt;&gt;';
            forebtn.onclick = function(){cycleFeatureData(iframeids, iframes, 'fore')};
            var titleElem = document.createElement('a');
            titleElem.id = 'overlayTitleElem';
            titleElem.href='/chersonesos/ark//micro_view.php?item_key=cxt_cd&cxt;_cd='+ark_id;
            titleElem.innerHTML = '&lt;h5&gt;Context '+ark_id+'&lt;/h5&gt;';
            titlebar.appendChild(backbtn);
            titlebar.appendChild(titleElem);
            titlebar.appendChild(forebtn);
            iframes[ark_id].style.display = 'inline';
            overlay.getElement().appendChild(titlebar);
            overlay.getElement().appendChild(data);
        } else {
            iframes = {};
            iframeids = [];

            multiSelectOverlay.getSource().clear();
            multiSelectOverlay.getSource().addFeatures(collection);

            overlay.getElement().style.display = 'none';
        }
    };

    map1.on('click', function(evt) {
        var pixel = map1.getEventPixel(evt.originalEvent);
        displayFeatureInfo(pixel);
    });


    firstselectconf_field_cxt_schm =true;
    map1.getLayers().forEach(function(i,e,a){
    i.on('change', function (event) {
    var source = i.getSource();
    if (source.getState() == 'ready' && firstselectconf_field_cxt_schm ) {
    if (i.get('name')=='Context Schema'){
    collection.clear();
    spat = false;
    console.log(map1.getView().getCenter());
    i.getSource().getFeatures().forEach(function(e,i,a){
    if(e.get('ark_id') != null){
    if(e.get('ark_id').toUpperCase()=='CH05SR_639'){
    firstselectconf_field_cxt_schm = false;
    
    var selectedOverlay = new ol.layer.Vector({
        source: new ol.source.Vector(),
        map: map1,
        style: new ol.style.Style({
            image: new ol.style.Circle({
                radius: 6,
                fill: new ol.style.Fill({color: 'rgba(255, 255, 255, 0.6)'}),
                stroke: new ol.style.Stroke({color: '#e29446', width: 1})
            }),
            fill: new ol.style.Fill({color: 'rgba(255, 86, 29, 0.6)'}),
            stroke: new ol.style.Stroke({color: '#e29446', width: 2})
        }),
        projection:'EPSG:32636',
    });
    selectedOverlay.set('name', "selectedOverlay");

    selectedOverlay.getSource().addFeature(e);
    overlay.getElement().style.display = 'none';
    spat = true;
    map1.updateSize();
    extent = e.getGeometry().getExtent();
    if(2){
    extent[0]=extent[0]-2;
    extent[1]=extent[1]-2;
    extent[2]=extent[2]+2;
    extent[3]=extent[3]+2;
}
console.log(map1.getView().getCenter());
map1.getView().fit(
extent,
map1.getSize()
);
console.log(map1.getView().getCenter());

}
}
});
if(!spat){
console.log($('#'+map1.getTarget()));
var nospat = document.createElement('div');
nospat.setAttribute("id","message");
$(nospat).html("No Spatial Data");
$('#'+map1.getTarget()).prepend(nospat);
}
}
}
});
});
      </script>
      <link rel="stylesheet" href="../lib/js/ol3/ol.css" />
      <link rel="stylesheet" href="../skins/arkologik/stylesheets/map_view.css" />
     </div>
     <div id="sph_xmiconf_xmi_viewer" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Site Photos
       </h4>
      </div>
      <ul id="existing-sph" class="xmi_list">
       <li>
        <h5 style="width: 100%">
         Site Photo:
         <a href="../sph_cd/CH05SR_785.html">
          CH05SR_785
         </a>
        </h5>
        <ul id="fields-for-CH05SR_785" class="xmi_field">
         <li>
          <label class="form_label">
           Image(s)
          </label>
          <span class="data">
           <a href="../data/files/webthumb_6730.jpg" class="imagebox" title="CH05SR_785">
            <img src="../data/files/arkthumb_6730.jpg" alt="file_image" />
           </a>
          </span>
         </li>
         <li>
          <label class="form_label">
           Description
          </label>
          <span class="data">
           Room 37, trench for wall foundation
          </span>
         </li>
        </ul>
       </li>
       <li>
        <h5 style="width: 100%">
         Site Photo:
         <a href="../sph_cd/CH05SR_786.html">
          CH05SR_786
         </a>
        </h5>
        <ul id="fields-for-CH05SR_786" class="xmi_field">
         <li>
          <label class="form_label">
           Image(s)
          </label>
          <span class="data">
           <a href="../data/files/webthumb_6731.jpg" class="imagebox" title="CH05SR_786">
            <img src="../data/files/arkthumb_6731.jpg" alt="file_image" />
           </a>
          </span>
         </li>
         <li>
          <label class="form_label">
           Description
          </label>
          <span class="data">
           Room 37, trench for wall foundation
          </span>
         </li>
        </ul>
       </li>
       <li>
        <h5 style="width: 100%">
         Site Photo:
         <a href="../sph_cd/CH05SR_788.html">
          CH05SR_788
         </a>
        </h5>
        <ul id="fields-for-CH05SR_788" class="xmi_field">
         <li>
          <label class="form_label">
           Image(s)
          </label>
          <span class="data">
           <a href="../data/files/webthumb_6733.jpg" class="imagebox" title="CH05SR_788">
            <img src="../data/files/arkthumb_6733.jpg" alt="file_image" />
           </a>
          </span>
         </li>
         <li>
          <label class="form_label">
           Description
          </label>
          <span class="data">
           Room 37, trench for wall foundation
          </span>
         </li>
        </ul>
       </li>
       <li>
        <h5 style="width: 100%">
         Site Photo:
         <a href="../sph_cd/CH05SR_794.html">
          CH05SR_794
         </a>
        </h5>
        <ul id="fields-for-CH05SR_794" class="xmi_field">
         <li>
          <label class="form_label">
           Image(s)
          </label>
          <span class="data">
           <a href="../data/files/webthumb_6739.jpg" class="imagebox" title="CH05SR_794">
            <img src="../data/files/arkthumb_6739.jpg" alt="file_image" />
           </a>
          </span>
         </li>
         <li>
          <label class="form_label">
           Description
          </label>
          <span class="data">
           Room 37, general view
          </span>
         </li>
        </ul>
       </li>
       <li>
        <h5 style="width: 100%">
         Site Photo:
         <a href="../sph_cd/CH05SR_795.html">
          CH05SR_795
         </a>
        </h5>
        <ul id="fields-for-CH05SR_795" class="xmi_field">
         <li>
          <label class="form_label">
           Image(s)
          </label>
          <span class="data">
           <a href="../data/files/webthumb_6740.jpg" class="imagebox" title="CH05SR_795">
            <img src="../data/files/arkthumb_6740.jpg" alt="file_image" />
           </a>
          </span>
         </li>
         <li>
          <label class="form_label">
           Description
          </label>
          <span class="data">
           Room 37, general view
          </span>
         </li>
        </ul>
       </li>
       <li>
        <h5 style="width: 100%">
         Site Photo:
         <a href="../sph_cd/CH05SR_796.html">
          CH05SR_796
         </a>
        </h5>
        <ul id="fields-for-CH05SR_796" class="xmi_field">
         <li>
          <label class="form_label">
           Image(s)
          </label>
          <span class="data">
           <a href="../data/files/webthumb_6741.jpg" class="imagebox" title="CH05SR_796">
            <img src="../data/files/arkthumb_6741.jpg" alt="file_image" />
           </a>
          </span>
         </li>
         <li>
          <label class="form_label">
           Description
          </label>
          <span class="data">
           Room 37, general view of SW part
          </span>
         </li>
        </ul>
       </li>
      </ul>
     </div>
     <div id="cxt_sketch_display" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Sketches
       </h4>
      </div>
      <ul>
       <li class="row">
        <span class="value">
         There are no files attached to this record yet.
        </span>
       </li>
      </ul>
     </div>
     <div id="gph_xmiconf_xmi_viewer" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Linked GeoPhotos
       </h4>
      </div>
      <ul id="existing-gph" class="xmi_list">
       <li>
        <h5 style="width: 100%">
         Geophoto:
         <a href="../gph_cd/CH05SR_323.html">
          CH05SR_323
         </a>
        </h5>
        <ul id="fields-for-CH05SR_323" class="xmi_field">
         <li>
          <label class="form_label">
           Description
          </label>
          <span class="data">
           Feature w/ Ash &amp; Mudbrick S of ROOM 37
          </span>
         </li>
        </ul>
       </li>
      </ul>
     </div>
     <div id="drw_xmiconf_xmi_viewer" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Linked Drawings
       </h4>
      </div>
      <ul>
       <li class="row">
        <label class="form_label">
         Drawing
        </label>
        <span class="value">
         No attached items.
        </span>
       </li>
      </ul>
     </div>
     <div id="tps_xmiconf_xmi_viewer" class="mc_subform">
      <div class="sf_nav">
       <h4>
        Linked TopoSurfaces
       </h4>
      </div>
      <ul>
       <li class="row">
        <label class="form_label">
         Topo Surface
        </label>
        <span class="value">
         No attached items.
        </span>
       </li>
      </ul>
     </div>
     <div id="pmp_xmiconf_xmi_viewer" class="mc_subform">
      <div class="sf_nav">
       <h4>
        PhotoModeler Projects
       </h4>
      </div>
      <ul>
       <li class="row">
        <label class="form_label">
         PMP
        </label>
        <span class="value">
         No attached items.
        </span>
       </li>
      </ul>
     </div>
    </div>
    <!-- end MAIN -->
   </div>
   <!-- ARK FOOTER -->
   <div id="ark_footer">
    <div class="bt-nav">
     <span>
      Guest User
     </span>
     <span>
      <a href="../micro_view.html">
       English
      </a>
     </span>
     <span>
      <a href="../micro_view.html">
       Russian
      </a>
     </span>
     <span>
      <a href="http://ark.lparchaeology.com/wiki">
       Help
      </a>
     </span>
     <span class="noborder">
      <a href="../index.html">
       Logout
      </a>
     </span>
    </div>
    <div class="credits">
     <p>
      Powered by
     </p>
     <span class="noborder">
      <a title="ARK" href="http://ark.lparchaeology.com">
       ARK
      </a>
     </span>
    </div>
   </div>
   <!-- end WRAPPER -->
  </div>
 </body>
</html>
